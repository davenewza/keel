PR submitted to charmbracelet/bubbles to expose Viewport TotalLineCount() (PR at https://github.com/charmbracelet/bubbles/pull/283) which is necessary for our use case. Will await merge and release (which could be some time based on their release cycle), and then delete these files afterwards. In the meantime, I have copied the source code from https://github.com/charmbracelet/bubbles/tree/master/viewport and modified it to match the PR.