model Account {
    fields {
        name Text @on([update], verifyEmail)
    }

    actions {
        create createAccount() with (name) {
            @on([create], sendWelcomeMail)
        }
        
        update updateAccount() {
            @on(sendWelcomeMail)
            @on([update], verifyEmail)
            @function
        }
    }
}

job CheckAccount {
    @permission(expression: ctx.isAuthenticated)
    @on([create], sendWelcomeMail)
}